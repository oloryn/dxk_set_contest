#!/usr/bin/env py
"""
Create a DXKeeper script that will set QSOs from an ADIF file to a passed
contest id in DXKeeper
"""

import argparse
from typing import List, Dict
import winreg

import adif


def import_adif(adif_filename: str) -> List[Dict]:
    """Import QSOS from ADIF file"""

    parser = adif.Parser()
    parser.parsefile(adif_filename)

    return parser.contacts


def main():
    """Set DXKeeper contest for QSOs in selected ADIF file"""

    # Get arguments rom command line
    parser = argparse.ArgumentParser(
        description="Set DXKeeper contest for QSOs in selected ADIF file"
    )

    parser.add_argument("contestname")
    parser.add_argument("adif_filename")

    args = parser.parse_args()

    # import QSOs from ADIF file
    qsos = import_adif(args.adif_filename)

    # Get DXKeeper Scripts directory from registry
    dxkeeper_reg = winreg.OpenKeyEx(
        winreg.HKEY_CURRENT_USER,
        "SOFTWARE\\VB and VBA Program Settings\\DXKeeper\\Configuration"
    )
    script_directory = winreg.QueryValueEx(dxkeeper_reg, "ScriptDirectory")[0]


main()
